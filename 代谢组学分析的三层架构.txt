📊 代谢组学分析的三层架构
________________________________________
层级1：描述性分析（必做）
目标：建立金属与代谢物的关联图谱
分析1. 1：金属-代谢物相关矩阵
•	方法：Spearman相关（因代谢物常偏态）
•	输出：
o	相关系数矩阵（19金属 × N代谢物）
o	热图可视化（Heatmap）
o	FDR校正（控制假阳性）
•	解释：
o	识别"金属敏感的代谢物"（如高相关，r>0.3，P<0.001）
o	例如：铜与氧化应激标志物（如MDA, 8-iso-PGF2α）
分析1.2：代谢物的组间差异（LVR vs 非LVR）
•	方法：
o	连续变量：加权t检验（使用IPW权重）
o	多重检验：FDR或Bonferroni校正
•	输出：
o	差异代谢物列表（按P值排序）
o	火山图（Volcano plot）：横轴=Log2FC，纵轴=-Log10(P)
•	解释：
o	识别"LVR相关的代谢物"
o	后续重点关注：既与金属相关，又与LVR相关的代谢物
________________________________________
层级2：通路富集分析（必做）
目标：从单个代谢物上升到生物学通路
分析2.1：代谢通路富集（Pathway Enrichment）
•	工具：
o	MetaboAnalyst（网页版，最常用）
o	KEGG Mapper（更详细）
•	输入：
o	差异代谢物列表（P<0.05的代谢物）
o	或：与特定金属高度相关的代谢物（r>0.3）
•	输出：
o	富集的通路列表（按FDR排序）
o	通路图（标注差异代谢物的位置）
•	示例通路（预期可能显著）：
o	氧化应激通路（Glutathione metabolism）
	如果Cu/Fe与GSH/GSSG比值相关
o	能量代谢（TCA cycle）
	如果金属影响线粒体功能
o	脂质代谢（Fatty acid β-oxidation）
	如果与心肌能量底物相关
o	炎症通路（Arachidonic acid metabolism）
	如果Pb/As与前列腺素相关
分析2.2：基因集富集分析（GSEA-Metabolite）
•	方法：
o	不设P值阈值，使用全部代谢物
o	按与LVR的相关系数排序
o	检验"金属相关代谢物集"是否整体富集在LVR高端
•	优势：
o	比单个代谢物检验更有统计功效
o	可以检测弱效应的累积
•	输出：
o	Enrichment Score（ES）和P值
o	Leading Edge代谢物（贡献最大的子集）
________________________________________
层级3：中介分析（核心创新）
目标：检验"金属 → 代谢物 → LVR"的间接效应
理论框架：
代码
总效应（c） = 直接效应（c'） + 间接效应（a × b）

其中：
a = 金属对代谢物的效应
b = 代谢物对LVR的效应（调整金属后）
c = 金属对LVR的总效应（已知≈0）
c' = 金属对LVR的直接效应（调整代谢物后）
分析3.1：单中介模型
•	适用于：重点代谢物（如文献已知的标志物）
•	步骤：
i.	模型M（中介变量模型）：
代码
代谢物 = α + a·金属 + 协变量 + ε_M
ii.	模型Y（结局模型）：
代码
LVR = β + c'·金属 + b·代谢物 + 协变量 + ε_Y
iii.	间接效应：
代码
ACME (Average Causal Mediation Effect) = a × b
iv.	Bootstrap置信区间（1000次）：
	如果95% CI不包含0 → 中介效应显著
•	关键解释：
i.	如果ACME显著但总效应c≈0 → 完全中介
	例如："铅通过氧化应激完全中介其对LVR的影响，但直接效应为0"
ii.	如果ACME显著且c'也显著 → 部分中介
iii.	如果ACME不显著 → 无中介
分析3.2：多中介模型（高级）
•	适用于：通路水平的中介（如整个氧化应激通路）
•	方法：
o	将通路内的多个代谢物作为并联中介
o	使用结构方程模型（SEM）或高维中介分析
•	工具：
o	R包：mediation（基础）、medflex（灵活）、HIMA（高维）
•	输出：
o	每个代谢物的中介比例（Proportion Mediated）
o	总中介效应（所有代谢物的联合贡献）
分析3.3：IPW加权的中介分析
•	创新点：整合IPW权重到中介分析
•	实现方式：
o	在Bootstrap过程中使用IPW权重
o	或使用survey包的svyglm拟合模型M和Y
•	重要性：
o	确保中介效应的估计也调整了选择偏倚
o	这是方法学上的重要贡献（少有文献做到）
________________________________________
层级4：金属-代谢物交互（探索性）
目标：检验"金属对LVR的效应是否依赖于代谢物水平"
分析4.1：双向交互
•	模型：
代码
LVR = β0 + β1·金属 + β2·代谢物 + β3·(金属×代谢物) + 协变量 + ε
•	关键参数：β3（交互项系数）
•	解释：
o	如果β3显著 → "金属的效应在不同代谢物水平下不同"
o	例如："高GSH水平时，铜的促氧化作用被中和"
分析4.2：分层分析（可视化交互）
•	方法：
o	将代谢物分为三分位数（低/中/高）
o	在每个分层内拟合金属-LVR关系
•	输出：
o	分层森林图（3条线，代表不同代谢物水平）
o	如果线条不平行 → 存在交互

